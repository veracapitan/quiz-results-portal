import { motionValue } from 'motion-dom';
<<<<<<< HEAD
import { isKeyframesTarget } from '../../animation/utils/is-keyframes-target.mjs';
=======
import { resolveFinalValueInKeyframes } from '../../utils/resolve-value.mjs';
>>>>>>> 3b008e380491e6ba2d199016330fcd7fa128de4c
import { resolveVariant } from './resolve-dynamic-variants.mjs';

/**
 * Set VisualElement's MotionValue, creating a new MotionValue for it if
 * it doesn't exist.
 */
function setMotionValue(visualElement, key, value) {
    if (visualElement.hasValue(key)) {
        visualElement.getValue(key).set(value);
    }
    else {
        visualElement.addValue(key, motionValue(value));
    }
}
<<<<<<< HEAD
function resolveFinalValueInKeyframes(v) {
    // TODO maybe throw if v.length - 1 is placeholder token?
    return isKeyframesTarget(v) ? v[v.length - 1] || 0 : v;
}
=======
>>>>>>> 3b008e380491e6ba2d199016330fcd7fa128de4c
function setTarget(visualElement, definition) {
    const resolved = resolveVariant(visualElement, definition);
    let { transitionEnd = {}, transition = {}, ...target } = resolved || {};
    target = { ...target, ...transitionEnd };
    for (const key in target) {
        const value = resolveFinalValueInKeyframes(target[key]);
        setMotionValue(visualElement, key, value);
    }
}

export { setTarget };
